# 03-路由的使用&中间件

###### 上节课的问题

`npm start` 等价于`npm run start`

需要记住一些命令的缩写`npm install`=>`npm i` ，也可以用Dash的snippet功能来实现。

## 路由

路由的解析是一层层递进的，与JS的脚本单线程的运行方式相同，一行一行的读取，一行一行的处理，在路由里也是如此，当一个请求出现的时候，会有相应的路由来处理，如果不属于这个路由的，就自动到下一个路由进行处理。

其中的`app.use` 和`app.set`就是负责路由的处理的。

## `app.js` 解析

![](https://ws1.sinaimg.cn/large/006tNc79gy1frs2gpz2voj30kd0ymwjz.jpg)

1～6行，使用第三方库

8～9行，定义路由路径

11行，app设置

14～15行，设置对views的访问

19～23行，调用中间件分析数据

25～26行，路由访问

19～44行，容错机制

46行，设置对外暴露app的模块

#### `app.use()`的使用

```js
app.use('/', function(){
    ********
});
```

`app.use()`有两个参数，一个是对应的路径，在上面的代码中，几个中间件的代码其实都省略了第一个参数，添加了一个通配符的路径`app.use('*', logger('dev'));`，所以地方的请求和数据都需要从这里过，再`next()`。

第二个参数是对应的处理，可以是一个函数，也可以是一个操作……

## 中间件的作用

> 分析数据，是的后面的路由能更好的处理和使用数据。

中间件其实是很多前人开发的库或者包，使得开发的效率大大提升。开发者不需要考虑的问题是CPU如何更高效，这是封装包的人考虑的问题（做技术的需要了解）。

$e.g.$ `req.body.title`与`req.body.content`就是通过中间件的处理之后得到的结果，能让开发者更直观的看到对应的信息。

## 路由之后呢？

在路由得到对应的请求和数据之后，路由做了一件事情——**响应**。

得到响应之后，一个路由的执行过程就结束了。

## 框架的好处

帮助你在无形中走出各种坑！

---

作业：

```js
res.send()
res.end()
res.json()
res.render()
```

这四者的作用分别是什么？

